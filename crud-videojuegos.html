<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>CRUD Videojuegos | More Games Store</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/reset.css" />
    <link rel="stylesheet" type="text/css" href="stylesheets/main2.css" />

</head>

<body>

    <div id="header">

        <div class="container">

            <h1>CRUD Videojuegos</h1>
            <div id="main_menu">

                <ul>
                    <li class="first_list"><a href="login.html" class="main_menu_first"
                        sessionStorage.clear()>Cerrar Sesión</a></li>
                </ul>

            </div> <!-- END #main_menu -->

        </div> <!-- END .container -->

    </div> <!-- END #header -->

    <div id="main_content">

        <div id="portfolio_area">

            <div class="container">

                <div id="portfolio_menu">

                    <ul>
                        <li><a href="catalogo.html">Catálogo de Videojuegos</a></li>
                        <li><a href="biblioteca.html">Mi Biblioteca</a></li>
                        <li><a href="perfil.html">Perfil</a></li>
                        <li><a href="carga-masiva.html">Carga Masiva</a></li>
                        <li><a href="crud-videojuegos.html">CRUD de Videojuegos</a></li>
                        <li><a href="reportes.html">Generar Reportes</a></li>
                        <li><a href="crear-usuario.html">Crear Usuario</a></li>
                    </ul>

                </div> <!-- END #portfolio_menu -->

            </div> <!-- END .container -->

        </div> <!-- END #portfolio_area -->

    </div> <!-- END #main_content -->


    <div id="main_content">

        <div class="container3">

            <center>

                <h3>SELECCIONA UNA OPCIÓN:</h3>
                </br>
                </br>
                <button type="button" class="btn btn-success" onclick="crear()">Crear Videojuego</button>
                <button type="button" class="btn btn-primary" onclick="ver()">Ver Videojuego</button>
                <button type="button" class="btn btn-primary" onclick="modificar()">Modificar Videojuego</button>
                <button type="button" class="btn btn-delete" onclick="eliminar()">Eliminar Videojuego</button>
            </center>


        </div> <!-- END .container -->


    </div> <!-- END #main_content -->


    <div id="main_content2">



    </div> <!-- END #main_content -->

    <script>

        var usuarioG = sessionStorage.getItem('usuario');
        var idG = sessionStorage.getItem('id');

        function crear() {

            var infoCrear = document.querySelector('#main_content2')

            infoCrear.innerHTML = `
            <div class="container3">
        </br>
        </br>

            <h3>DATOS DE VIDEOJUEGO:</h3>
        </br>
        </br>

        <form id="contact_form" role="form">
            <fieldset>
                <ol>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="nombre">Nombre:</label><input type="text"
                            size="60" maxlength="" id="nombre" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="anio">Año:</label><input type="text" size="60"
                            maxlength="" id="anio" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="precio">Precio:</label><input type="text"
                            size="60" maxlength="" id="precio" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="cat1">Categoría 1:</label><input type="text"
                            size="60" maxlength="" id="cat1" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="cat2">Categoría 2:</label><input type="text"
                            size="60" maxlength="" id="cat2" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="cat3">Categoría 3:</label><input type="text"
                            size="60" maxlength="" id="cat3" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="foto">URL Foto:</label>
                        <input type="text" size="60" maxlength="" id="foto" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="banner">URL Banner:</label>
                        <input type="text" size="60" maxlength="" id="banner" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="desc">Agregar Descripción:</label>
                        <textarea name="desc" rows="7" cols="100" id="desc"></textarea>
                    </li>
                    <li>
                        </br>
                        </br>
                        <button type="button" class="btn btn-primary" onclick="crearJuego()">Crear
                            Videojuego</button>
                    </li>


                </ol>

            </fieldset>
        </form>

        </div>
            
            `
        }

        function ver() {

            var infoCrear = document.querySelector('#main_content2')

            infoCrear.innerHTML = `
            <div  class="container3">
            </br>
            </br>

            <h3>SELECCIONA UN JUEGO:</h3>

            <div id="footer2">
            <div class="container">

            <div id="main_menu2">
            

            <select class="second_list second_list_border" id="categorias">
                
                
            </select>
           

            </div> <!-- END #main_menu -->
            <div >

            <button type="button" class="btn2 btn-categoria" onclick="verJuego()">Mostrar Juego</button>
             
            </div>
        
            </div>

            </div>

            </br>
            </br>

            <center>

                <h3>INFORMACIÓN DEL JUEGO</h3>

            </center>

            </br>
            </br>

            <div>
                <table class="styled-table" style="text-align: center; margin: auto;">
                    <thead>
                         <tr>
                            <th>Id</th>
                            <th>Nombre</th>
                            <th>Año</th>
                            <th>Precio</th>
                            <th>Categoría 1</th>
                            <th>Categoría 2</th>
                            <th>Categoría 3</th>
                        </tr>
                    </thead>
                    <tbody id="info1">
                        
                    </tbody>
                </table>
            </div>

            <div>
                <table class="styled-table" style="text-align: center; margin: auto;">
                    <thead>
                        <tr>
                            <th>Foto</th>
                            <th>Banner</th>
                
                        </tr>
                    </thead>
                    <tbody id="info2">
                        
            

                    </tbody>
                </table>
            </div>

            <div id="footer2"></div>


            </div> 


            </div> 
            
            `

            fetch('https://backend-proyecto2-ipc1.herokuapp.com/mostrar-juegos', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(res => res.json())
                .catch(err => {
                    console.log(err)
                    alert('Ocurrió un Error')
                })
                .then(response => {
                    var videojuegos = response;
                    var lista_juegos = document.querySelector('#categorias')

                    videojuegos.forEach(juego => {

                        lista_juegos.innerHTML += `
                        <option value="${juego['id']}">${juego['nombre']}</option>
                        `
                    });

                })

        }


        function verJuego() {

            var seleccion = document.getElementById("categorias").value

            fetch('https://backend-proyecto2-ipc1.herokuapp.com/info-juego?id=' + seleccion, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(res => res.json())
                .catch(err => {
                    console.log(err)
                    alert('Ocurrió un Error')
                })

                .then(response => {
                    console.log(response)
                    var info = response['data'];

                    var tabla1 = document.querySelector('#info1')
                    var tabla2 = document.querySelector('#info2')

                    tabla1.innerHTML = `
                    <tr>
                        <td>${info['id']}</td>
                        <td>${info['nombre']}</td>
                        <td>${info['anio']}</td>
                        <td>Q.${info['precio']}</td>
                        <td>${info['categoria1']}</td>
                        <td>${info['categoria2']}</td>
                        <td>${info['categoria3']}</td>
                    </tr>
                    `
                    tabla2.innerHTML = `
                    <tr>
                        <td> <img src=${info['foto']} height="290"
                         /></td>
                        <td><img src=${info['banner']} height="250"
                            width="500" /></td>
                
                    </tr>
                    
                    `


                });


        }

        function modificar() {

            var infoCrear = document.querySelector('#main_content2')

            infoCrear.innerHTML = `
            
            <div class="container3">

            </br>
            </br>

            <h3>SELECCIONA UN JUEGO:</h3>

            <div id="footer2">
            <div class="container">

            <div id="main_menu2">
            
            <select class="second_list second_list_border" id="categorias">

                
            </select>
           

            </div> <!-- END #main_menu -->
            <div >

            <button type="button" class="btn2 btn-categoria" onclick="mostrarInfo()">Mostrar Videojuego</button>
             
            </div>
        
            </div>

            </div>
            </br>
            </br>
                <h3>DATOS DE VIDEOJUEGO:</h3>
            </br>
            </br>

            <form id="contact_form" role="form">
            <fieldset>
                <ol>
                    <li>
                         <!-- END #contact_info_left -->
                         <label style="font-size: large;" for="nombre">Nombre:</label><input type="text"
                            size="60" maxlength="" id="nombre" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="anio">Año:</label><input type="text" size="60"
                            maxlength="" id="anio" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="precio">Precio:</label><input type="text"
                            size="60" maxlength="" id="precio" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="cat1">Categoría 1:</label><input type="text"
                            size="60" maxlength="" id="cat1" />
                    </li>
                    <li>
                            <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="cat2">Categoría 2:</label><input type="text"
                            size="60" maxlength="" id="cat2" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="cat3">Categoría 3:</label><input type="text"
                            size="60" maxlength="" id="cat3" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="foto">URL Foto:</label>
                        <input type="text" size="80" maxlength="" id="foto" />
                    </li>
                    <li>
                         <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="banner">URL Banner:</label>
                        <input type="text" size="80" maxlength="" id="banner" />
                    </li>
                    <li>
                        <!-- END #contact_info_left -->
                        <label style="font-size: large;" for="desc">Agregar Descripción:</label>
                        <textarea name="desc" rows="9" cols="100" id="desc"></textarea>
                    </li>
                    <li>
                     </br>
                    </br>
                        <button type="button" class="btn btn-primary" onclick="modificarJuego()">Modificar
                            Videojuego</button>
                    </li>


                </ol>

            </fieldset>
            </form>
  
            `
            fetch('https://backend-proyecto2-ipc1.herokuapp.com/mostrar-juegos', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(res => res.json())
                .catch(err => {
                    console.log(err)
                    alert('Ocurrió un Error')
                })
                .then(response => {
                    var videojuegos = response;
                    var lista_juegos = document.querySelector('#categorias')

                    videojuegos.forEach(juego => {

                        lista_juegos.innerHTML += `
                        <option value="${juego['id']}">${juego['nombre']}</option>
                        `
                    });

                })

        }

        function mostrarInfo() {

            var seleccion = document.getElementById("categorias").value

            fetch('https://backend-proyecto2-ipc1.herokuapp.com/info-juego?id=' + seleccion, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(res => res.json())
                .catch(err => {
                    console.log(err)
                    alert('Ocurrió un Error')
                })

                .then(response => {
                    console.log(response)
                    var info = response['data'];

                    document.getElementById("nombre").value = info['nombre']
                    document.getElementById("anio").value = info['anio']
                    document.getElementById("precio").value = info['precio']
                    document.getElementById("cat1").value = info['categoria1']
                    document.getElementById("cat2").value = info['categoria2']
                    document.getElementById("cat3").value = info['categoria3']
                    document.getElementById("foto").value = info['foto']
                    document.getElementById("banner").value = info['banner']
                    document.getElementById("desc").value = info['descripcion']

                });

        }


        function crearJuego() {

            var nombre = document.getElementById("nombre").value
            var anio = document.getElementById("anio").value
            var precio = document.getElementById("precio").value
            var cat1 = document.getElementById("cat1").value
            var cat2 = document.getElementById("cat2").value
            var cat3 = document.getElementById("cat3").value
            var foto = document.getElementById("foto").value
            var banner = document.getElementById("banner").value
            var descripción = document.getElementById("desc").value

            fetch('https://backend-proyecto2-ipc1.herokuapp.com/creacion-juego', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    "nombre": nombre,
                    "anio": anio,
                    "precio": precio,
                    "cat1": cat1,
                    "cat2": cat2,
                    "cat3": cat3,
                    "foto": foto,
                    "banner": banner,
                    "descripcion": descripción
                })
            })
                .then(res => res.json())
                .catch(err => {
                    console.log(err)
                    window.alert("Error")
                })
                .then(response => {
                    console.log(response)

                    if (response.estado == 1) {
                        window.alert("Se registro " + response.nombre + " en el catálogo")

                    }

                    else {
                        window.alert("Ocurrió un Error")
                    }

                })


        }

        function modificarJuego() {

            var seleccion = document.getElementById("categorias").value
            var nombre = document.getElementById("nombre").value
            var anio = document.getElementById("anio").value
            var precio = document.getElementById("precio").value
            var cat1 = document.getElementById("cat1").value
            var cat2 = document.getElementById("cat2").value
            var cat3 = document.getElementById("cat3").value
            var foto = document.getElementById("foto").value
            var banner = document.getElementById("banner").value
            var descripción = document.getElementById("desc").value

            fetch('https://backend-proyecto2-ipc1.herokuapp.com/modificar-juego', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    "id": seleccion,
                    "nombre": nombre,
                    "anio": anio,
                    "precio": precio,
                    "cat1": cat1,
                    "cat2": cat2,
                    "cat3": cat3,
                    "foto": foto,
                    "banner": banner,
                    "descripcion": descripción
                })
            })
                .then(res => res.json())
                .catch(err => {
                    console.log(err)
                    window.alert("Error")
                })
                .then(response => {
                    console.log(response)


                })


        }

        function ver() {

            var infoCrear = document.querySelector('#main_content2')

            infoCrear.innerHTML = `
            <div  class="container3">
            </br>
            </br>

            <h3>SELECCIONA UN JUEGO:</h3>

            <div id="footer2">
            <div class="container">

            <div id="main_menu2">
            

            <select class="second_list second_list_border" id="categorias">
                
                
            </select>
           

            </div> <!-- END #main_menu -->
            <div >

            <button type="button" class="btn2 btn-categoria" onclick="verJuego()">Mostrar Videojuego</button>
             
            </div>
        
            </div>

            </div>

            </br>
            </br>

            <center>

                <h3>INFORMACIÓN DEL JUEGO</h3>

            </center>

            </br>
            </br>

            <div>
                <table class="styled-table" style="text-align: center; margin: auto;">
                    <thead>
                         <tr>
                            <th>Id</th>
                            <th>Nombre</th>
                            <th>Año</th>
                            <th>Precio</th>
                            <th>Categoría 1</th>
                            <th>Categoría 2</th>
                            <th>Categoría 3</th>
                        </tr>
                    </thead>
                    <tbody id="info1">
                        
                    </tbody>
                </table>
            </div>

            <div>
                <table class="styled-table" style="text-align: center; margin: auto;">
                    <thead>
                        <tr>
                            <th>Foto</th>
                            <th>Banner</th>
                
                        </tr>
                    </thead>
                    <tbody id="info2">
                        
            

                    </tbody>
                </table>
            </div>

            <div id="footer2"></div>


            </div> 


            </div> 
            
            `

            fetch('https://backend-proyecto2-ipc1.herokuapp.com/mostrar-juegos', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(res => res.json())
                .catch(err => {
                    console.log(err)
                    alert('Ocurrió un Error')
                })
                .then(response => {
                    var videojuegos = response;
                    var lista_juegos = document.querySelector('#categorias')

                    videojuegos.forEach(juego => {

                        lista_juegos.innerHTML += `
                        <option value="${juego['id']}">${juego['nombre']}</option>
                        `
                    });

                })

        }

        function eliminar() {

            var infoCrear = document.querySelector('#main_content2')

            infoCrear.innerHTML = `
            <div  class="container3">
            </br>
            </br>

                <h3>SELECCIONA UN JUEGO:</h3>

            <div id="footer2">
            <div class="container">

            <div id="main_menu2">


                <select class="second_list second_list_border" id="categorias">
    
    
                </select>


            </div> <!-- END #main_menu -->
            <div >

                <button type="button" class="btn2 btn-delete" onclick="eliminarJuego()">Eliminar Videojuego</button>
 
            </div>

            </div>

            </div>

            `

            fetch('https://backend-proyecto2-ipc1.herokuapp.com/mostrar-juegos', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(res => res.json())
                .catch(err => {
                    console.log(err)
                    alert('Ocurrió un Error')
                })
                .then(response => {
                    var videojuegos = response;
                    var lista_juegos = document.querySelector('#categorias')

                    videojuegos.forEach(juego => {

                        lista_juegos.innerHTML += `
                            <option value="${juego['id']}">${juego['nombre']}</option>
                        `
                    });

                })

        }

        function eliminarJuego(){

            var seleccion = document.getElementById("categorias").value
            var lista_juegos = document.querySelector('#categorias')
            lista_juegos.innerHTML = ""

            fetch('https://backend-proyecto2-ipc1.herokuapp.com/eliminar-juego', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    "id": seleccion

                })
            })
                .then(res => res.json())
                .catch(err => {
                    console.log(err)
                    window.alert("Error")
                })
                .then(response => {
                    console.log(response)

                    if(response.estado == 1){

                        window.alert("Se eliminó el videojuego")
                    }
                    else{
                        window.alert("Ocurrió un error")
                    }


                })

            fetch('https://backend-proyecto2-ipc1.herokuapp.com/mostrar-juegos', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
                }
            })
                .then(res => res.json())
                .catch(err => {
                    console.log(err)
                    alert('Ocurrió un Error')
                })
                .then(response => {
                    var videojuegos = response;
                    

                    videojuegos.forEach(juego => {

                        lista_juegos.innerHTML += `
                            <option value="${juego['id']}">${juego['nombre']}</option>
                        `
                    });

                })    


        }


    </script>

</body>

</html>